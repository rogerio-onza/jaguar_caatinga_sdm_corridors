library(sf)
library(dplyr)
library(tibble)
library(readr)

# 1. Entrada dos Dados (60 Pares de Coordenadas únicos)
# A ordem segue exatamente a lista vertical que você enviou.
dados_sad69 <- tibble(
  id_sequencial = 1:60, # Ajustado para 60 pontos únicos
  lon = c(
    -43.0584100, -43.1486400, -42.9461500, -43.3444700, -42.8759000, 
    -40.1666800, -41.1401860, -41.1100270, -41.0462180, -40.9634130, 
    -43.3745000, -43.4125000, -39.2000000, -42.5036100, -41.9846000, 
    -42.5473800, -42.6743403, -41.0411300, -41.1508000, -38.6674000, 
    -38.8333000, -42.4485800, -40.7164700, -43.1263700, -40.5703300, 
    -41.2972800, -41.2479000, -41.2270000, -41.2116200, -41.1372900, 
    -43.1594100, -41.5000000, -42.4758600, -43.6143600, -42.2666600, 
    -42.8793800, -42.6310200, -41.7079600, -40.2309300, -41.7503500, 
    -41.4153800, -41.4181300, -41.6276600, -41.3403200, -41.0676380, 
    -41.9342100, -41.0778780, -41.1566700, -41.5165700, -41.1748700, 
    -41.6669000, -40.9753000, -40.9749000, -40.9836400, -42.8883700, 
    -39.4486400, -39.2756000, -41.8433600, -42.9700100, -42.9903700
  ),
  lat = c(
    -9.1903600, -11.0926900, -13.1909200, -13.1892800, -9.1716200, 
    -10.3500400, -10.2138110, -10.1841920, -9.9621900, -9.9071120, 
    -9.1740000, -9.0804000, -9.0515800, -8.8726500, -9.0156300, 
    -11.4782200, -13.8809926, -13.0461200, -12.9678000, -10.0736100, 
    -9.8333000, -8.5129700, -9.5788700, -9.2305900, -10.954600, 
    -10.722250, -11.673800, -11.607800, -11.509870, -10.981540, 
    -14.269140, -12.666700, -10.017720, -9.5036800, -9.5167100, 
    -8.7031600, -8.6151700, -12.3991300, -10.3923900, -10.6874900, 
    -10.3926700, -10.2671700, -10.0655600, -10.0469100, -10.0104770, 
    -10.0009000, -9.9614860, -9.9343800, -9.9255500, -9.9150000, 
    -9.8971800, -9.8746500, -9.8309500, -9.7632700, -8.3570100, 
    -9.8129200, -9.7245000, -10.5231700, -9.2342400, -11.0328100
  )
)

# 2. Conversão Geodésica
# SAD69 = EPSG 4618
# WGS84 = EPSG 4326
dados_wgs84 <- dados_sad69 %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4618) %>% 
  st_transform(crs = 4326) %>% 
  mutate(
    lon_wgs84 = st_coordinates(.)[,1],
    lat_wgs84 = st_coordinates(.)[,2]
  ) %>%
  st_drop_geometry()

# 3. Visualizar
print(dados_wgs84)

# 4. Salvar
write_csv(dados_wgs84, "jaguar_wgs84_morato_2014.csv")
